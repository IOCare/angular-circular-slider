/*!The MIT License (MIT)

Copyright (c) 2015 Prince John Wesley (princejohnwesley@gmail.com)
**/
!function(a,b){function c(a){return(0|a)===a}function d(a){return"boolean"==typeof a||"true"===a}function e(c){function d(a){return function(){return o[a]}}function f(a){return n[a]}function g(a){return function(){return f(a)}}function h(a){return parseFloat(a)||0}function i(a,b){return function(){return h(a())+h(b())}}function j(a){return function(b){return h(a(b))}}function k(){return b.element(n.offsetParent)}function l(){var a=n.getBoundingClientRect(),b=n.ownerDocument.documentElement;return{top:a.top+b.scrollTop-b.clientTop,left:a.left+b.scrollLeft-b.clientLeft}}function m(){var a=e(k()),b=a.offset(),d=l();return b.top+=h(a.css("borderTopWidth")),b.left+=h(a.css("borderLeftWidth")),{top:d.top-b.top-h(c.css("marginTop")),left:d.left-b.left-h(c.css("marginLeft"))}}var n=c[0],o=a.getComputedStyle(n,null);return{css:c.css,prop:f,width:j(d("width")),height:j(d("height")),outerWidth:i(i(g("offsetWidth"),d("marginLeft")),d("marginRight")),outerHeight:i(i(g("offsetHeight"),d("marginTop")),d("marginBottom")),innerWidth:i(i(d("width"),d("paddingLeft")),d("paddingRight")),innerHeight:i(i(d("height"),d("paddingTop")),d("paddingBottom")),offset:l,offsetParent:k,position:m}}function f(){return{template:j.template,restrict:"EA",transclude:!0,controller:h,controllerAs:"slider",scope:{csSlider:"=?",min:"@",max:"@",value:"=?",radius:"@",innerCircleRatio:"@",indicatorBallRatio:"@",handleDistRatio:"@",borderRatio:"@",clockwise:"@",shape:"@",touch:"@",animate:"@",animateDuration:"@",selectable:"@",onSlide:"@"},link:g}}function g(a,c,d,f){function g(){var b=m(),c=n();k[a.shape].drawShape(b,c),l(b,c);var d=e(b.acs),f=e(b.acsIndicator);i.acsPosition=d.position(),i.acsOuterArea=d.outerWidth()-d.width(),i.acsBallOuterArea=f.outerWidth()-f.width(),i.acsRadius=(d.width()+i.acsOuterArea)/2,i.acsBallRadius=(f.width()+i.acsBallOuterArea)/2,i.acsCenter=k[a.shape].getCenter(i.acsPosition,i.acsRadius),h(a.value||a.min)}function h(b){f.validateBinding("value");var c=a.clockwise?b:a.max-b,d=k[a.shape].val2Deg(c),e=d*Math.PI/180,g=m(),h=i.acsCenter.x+i.acsCenter.r*a.handleDistRatio*Math.cos(e)-i.acsBallRadius,j=i.acsCenter.y+i.acsCenter.r*a.handleDistRatio*Math.sin(e)-2*i.acsBallRadius;g.acsIndicator.css("top",j+"px"),g.acsIndicator.css("left",h+"px"),a.value=b,a.onSlide(b)}function l(b,c){b.acsIndicator.css({width:c*a.indicatorBallRatio+"px",height:c*a.indicatorBallRatio+"px"})}function m(){function d(){var d=c.children(),e=d.children(),g=b.element(e[0]),h=b.element(e[1]),j=g.children(),k={acsPanel:d,acs:g,acsIndicator:h,acsValue:j,scope:a,ctrl:f};return i.components=k}return i.components?i.components:d()}function n(){return Math.abs(parseInt(a.radius))||j.defaults.radius}b.forEach(a.$$isolateBindings,function(c,d){b.isUndefined(a[d])&&(a[d]=j.defaults[d])}),f.validateBindings(),c.addClass("acs-slider"),g(),a.csSlider={setValue:h}}function h(a){function e(a){return function(b,c){return[b,"(",c,") - Expected",a].join(" ")}}function f(a){b.forEach(i,function(c){b.forEach(c,function(b){var c=b.bindings;c.map(function(c){a[c]=a[c]||{tests:[]},a[c].tests.push({test:b.test,onError:b.onError})})})}),b.forEach(h,function(c){b.forEach(c.bindings,function(b){a[b].transform=c.transform})})}var g=["Circle","Half Circle","Half Circle Left","Half Circle Right","Half Circle Bottom"],h={integer:{bindings:["min","max","value","radius","animateDuration"],transform:parseInt},number:{bindings:["innerCircleRatio","borderRatio","indicatorBallRatio","handleDistRatio"],transform:parseFloat},"function":{bindings:["onSlide"],transform:function(a){return a?a:b.noop}}},i={type:{integer:{bindings:["min","max","value","radius","animateDuration"],test:c,onError:e("integer")},number:{bindings:["innerCircleRatio","borderRatio","indicatorBallRatio","handleDistRatio"],test:Number.isFinite,onError:e("number")},"boolean":{bindings:["touch","animate","selectable","clockwise"],test:d,onError:e("boolean")},"function":{bindings:["onSlide"],test:b.isFunction,onError:e("function")}},constraint:{range:{bindings:["min","max"],test:function(){return a.min<=a.max},onError:function(){return["Invalid slide range: [",a.min,",",a.max,"]"].join("")}},value:{bindings:["value"],test:function(b){return a.min<=b&&b<=a.max},onError:function(){return[a.value,"(value) out of range: [",a.min,",",a.max,"]"].join("")}},shape:{bindings:["shape"],test:function(){return-1!==g.indexOf(a.shape)},onError:function(){return["Unsupported shape: ",a.shape].join("")}},ratio:{bindings:["innerCircleRatio","handleDistRatio","borderRatio","indicatorBallRatio"],test:function(a){return a>=0&&1>=a},onError:function(a,b){return[a+"(",b,") is out of range: [0,1]"].join("")}}}};this.validateBindings=function(b){var c,d=b?b:this.props;for(c in d)d[c].transform&&(a[c]=d[c].transform(a[c])),d[c].tests.forEach(function(b){if(!b.test(a[c]))throw b.onError(c,a[c])})},this.validateBinding=function(a){if(!b.isUndefined(a)){var c={};c[a]=this.props[a],this.validateBindings(c)}},f(this.props={})}var i={},j={defaults:{min:0,max:359,value:0,radius:75,innerCircleRatio:"0.5",borderRatio:"0.1",indicatorBallRatio:"0.2",handleDistRatio:"1.0",clockwise:!0,shape:"Circle",touch:!0,animate:!0,animateDuration:360,selectable:!1,onSlide:b.noop},template:'      <div class="acs-panel">        <div class="acs">          <div class="acs-value" ng-transclude>          </div>        </div>        <div class="acs-indicator">        </div>      </div>    '},k={Circle:{drawShape:function(a,b){var c=2*b,d=c+"px",f=a.acs,g=a.acsValue,h=a.acsPanel,i=a.scope,j=b*i.borderRatio;f.css({width:d,height:d,"border-radius":d,"border-width":j+"px"});var k=c+j;h.css({"border-width":j+"px","border-radius":k+"px"});var l=e(f),m=e(g),n=i.innerCircleRatio*b;g.css({width:2*n+"px",height:2*n+"px","font-size":n/2+"px"});var o=b-n;g.css({top:o-l.prop("clientTop")-m.prop("clientTop")+"px",left:o-l.prop("clientLeft")-m.prop("clientLeft")+"px"})},getCenter:function(a,b){return{x:a.left+b,y:a.top+b,r:b}},deg2Val:function(a){var b=i.components.scope,c=b.max-b.min+1;if(0>a||a>359)throw"Invalid angle "+a;return a=(a+90)%360,Math.round(a*(c/360))+b.min},val2Deg:function(a){var b=i.components.scope,c=b.max-b.min+1;if(a<b.min||a>b.max)throw"Invalid range "+a;var d=a-b.min;return(Math.round(d*(360/c))-90)%360}},"Half Circle":{drawShape:function(a,b){var c=2*b,d=a.acs,f=a.acsValue,g=a.acsPanel,h=a.scope,i=b*h.borderRatio;d.css({width:c+"px",height:b+"px","border-radius":c+"px "+c+"px 0 0","border-bottom":"none","border-width":i+"px"});var j=c+i;g.css({"border-width":i+"px","border-radius":j+"px "+j+"px 0 0","border-bottom":"none"});var k=e(d),l=e(f),m=h.innerCircleRatio*b;f.css({width:2*m+"px",height:2*m+"px","font-size":m/2+"px"});var n=b-m;f.css({top:n-k.prop("clientTop")-l.prop("clientTop")+"px",left:n-k.prop("clientLeft")-l.prop("clientLeft")+"px"})},getCenter:function(a,b){return{x:a.left+b,y:a.top+b,r:b}},deg2Val:function(a){var b=i.components.scope,c=b.max-b.min+1;if(0>a||a>359)throw"Invalid angle "+a;return a=(a+180)%360,Math.round(a*(c/180))+b.min},val2Deg:function(a){var b=i.components.scope,c=b.max-b.min+1;if(a<b.min||a>b.max)throw"Invalid range "+a;var d=a-b.min;return(Math.round(d*(180/c))-180)%360}},"Half Circle Left":{drawShape:function(a,b){var c=2*b,d=a.acs,f=a.acsValue,g=a.acsPanel,h=a.scope,i=b*h.borderRatio;d.css({height:c+"px",width:b+"px","border-radius":c+"px 0 0 "+c+"px","border-right":"none","border-width":i+"px"});var j=c+i;g.css({"border-width":i+"px","border-radius":j+"px 0 0"+j+"px","border-right":"none"});var k=e(d),l=e(f),m=h.innerCircleRatio*b;f.css({width:2*m+"px",height:2*m+"px","font-size":m/2+"px"});var n=b-m;f.css({top:n-k.prop("clientTop")-l.prop("clientTop")+"px",left:n-k.prop("clientLeft")-l.prop("clientLeft")+"px"})},getCenter:function(a,b){return{x:a.left+2*b,y:a.top+2*b,r:2*b}},deg2Val:function(a){var b=i.components.scope,c=b.max-b.min+1;if(0>a||a>359)throw"Invalid angle "+a;return a=(a-90)%360,Math.round(a*(c/180))+b.min},val2Deg:function(a){var b=i.components.scope,c=b.max-b.min+1;if(a<b.min||a>b.max)throw"Invalid range "+a;var d=a-b.min;return(Math.round(d*(180/c))+90)%360}},"Half Circle Right":{drawShape:function(a,b){var c=2*b,d=a.acs,f=a.acsValue,g=a.acsPanel,h=a.scope,i=b*h.borderRatio;d.css({height:c+"px",width:b+"px","border-radius":"0 "+c+"px "+c+"px 0","border-left":"none","border-width":i+"px"});var j=c+i;g.css({"border-width":i+"px","border-radius":"0 "+j+"px"+j+"px 0","border-left":"none"});var k=e(d),l=e(f),m=h.innerCircleRatio*b;f.css({width:2*m+"px",height:2*m+"px","font-size":m/2+"px"});var n=b-m;f.css({top:n-k.prop("clientTop")-l.prop("clientTop")+"px",right:n-k.prop("clientLeft")-l.prop("clientLeft")+"px"})},getCenter:function(a,b){return{x:a.left,y:a.top+2*b,r:2*b}},deg2Val:function(a){var b=i.components.scope,c=b.max-b.min+1;if(0>a||a>359)throw"Invalid angle "+a;return a=(a+90)%360,Math.round(a*(c/180))+b.min},val2Deg:function(a){var b=i.components.scope,c=b.max-b.min+1;if(a<b.min||a>b.max)throw"Invalid range "+a;var d=a-b.min;return(Math.round(d*(180/c))-90)%360}},"Half Circle Bottom":{drawShape:function(a,b){var c=2*b,d=a.acs,f=a.acsValue,g=a.acsPanel,h=a.scope,i=b*h.borderRatio;d.css({width:c+"px",height:b+"px","border-radius":"0 0 "+c+"px "+c+"px","border-top":"none","border-width":i+"px"});var j=c+i;g.css({"border-width":i+"px","border-radius":"0 0 "+j+"px "+j+"px","border-top":"none"});var k=e(d),l=e(f),m=h.innerCircleRatio*b;f.css({width:2*m+"px",height:2*m+"px","font-size":m/2+"px"});var n=b-m;f.css({bottom:n-k.prop("clientTop")-l.prop("clientTop")+"px",left:n-k.prop("clientLeft")-l.prop("clientLeft")+"px"})},getCenter:function(a,b){return{x:a.left+b,y:a.top,r:b}},deg2Val:function(a){var b=i.components.scope,c=b.max-b.min+1;if(0>a||a>359)throw"Invalid angle "+a;return Math.round(a*(c/180))+b.min},val2Deg:function(a){var b=i.components.scope,c=b.max-b.min+1;if(a<b.min||a>b.max)throw"Invalid range "+a;var d=a-b.min;return Math.round(d*(180/c))}}};h.$inject=["$scope"],b.module("angular.circular-slider",[]).directive("circularSlider",f)}(window,window.angular);